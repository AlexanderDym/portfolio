// ========= –ö–û–ù–§–ò–ì –í–°–ï–• –ö–ï–ô–°–û–í =========

const CASES = [
  {
    id: "icon-cyprus",
    shortTitle: "I-CON Cyprus",
    title: "I-CON –Ω–∞ –ö–∏–ø—Ä–µ<br>Brand Experience Design",
    intro:
      "–ù—É–∂–Ω–æ –±—ã–ª–æ —Å–æ–∑–¥–∞—Ç—å —è—Ä–∫—É—é, –ª—ë–≥–∫—É—é –∏ –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–Ω—É—é –≤–∏–∑—É–∞–ª—å–Ω—É—é –∞–π–¥–µ–Ω—Ç–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è –±—ã –æ—â—É—â–∞–ª–∞—Å—å –∫–∞–∫ –ª–µ—Ç–Ω–∏–π –±—Ä–µ–Ω–¥, –∞ –Ω–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å—Ç–µ–Ω–¥.",
    theme: {
      bg: "#000000",
      accent: "#2f80ff",
    },
    // –∑–¥–µ—Å—å –º–æ–≥—É—Ç –±—ã—Ç—å –∏ —Å—Ç—Ä–æ–∫–∏ (–∫–∞—Ä—Ç–∏–Ω–∫–∏), –∏ –æ–±—ä–µ–∫—Ç—ã —Ç–∏–ø–∞ { type: "video", src, poster? }
    images: [
      "images/Image_here.png",
      "images/Image_here-1.png",
      "images/Image_here-2.png",
      "images/Image_here-3.png",
      "images/Image_here-4.png",
      "images/Image_here-5.png",
      "images/Image_here-6.png",
      "images/Image_here-7.png",
      "images/Image_here-8.png",
      "images/Image_here-9.png",
      // –ø—Ä–∏–º–µ—Ä, –∫–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ:
    ],
    textBlocks: [
      {
        title: "–ü—Ä–æ–±–ª–µ–º–∞",
        paragraphs: [
          "–ü–µ—Ä–µ–¥ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–µ–π I-CON –Ω–∞ –ö–∏–ø—Ä–µ —Å—Ç–æ—è–ª–∞ –∑–∞–¥–∞—á–∞ –≤—ã–¥–µ–ª–∏—Ç—å Trafee —Å—Ä–µ–¥–∏ –¥–µ—Å—è—Ç–∫–æ–≤ —Å—Ç–µ–Ω–¥–æ–≤ –∏ –±—Ä–µ–Ω–¥–æ–≤.",
          "–ù—É–∂–Ω–æ –±—ã–ª–æ —Å–æ–∑–¥–∞—Ç—å —è—Ä–∫—É—é, –ª—ë–≥–∫—É—é –∏ –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–Ω—É—é –≤–∏–∑—É–∞–ª—å–Ω—É—é –∞–π–¥–µ–Ω—Ç–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è –±—ã –æ—â—É—â–∞–ª–∞—Å—å –∫–∞–∫ –ª–µ—Ç–Ω–∏–π –±—Ä–µ–Ω–¥, –∞ –Ω–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å—Ç–µ–Ω–¥.",
        ],
      },
      {
        title: "–†–µ—à–µ–Ω–∏–µ",
        paragraphs: [
          "–ú—ã –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∏ –±—Ä–µ–Ω–¥ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é –ª–µ—Ç–Ω–µ–≥–æ –º–µ—Ä—á–∞: —Ñ—É—Ç–±–æ–ª–∫–∏, —Å—É–º–∫–∏ –∏ –ª–µ–Ω—Ç—ã –≤—ã–≥–ª—è–¥–µ–ª–∏ –∫–∞–∫ –ª–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–∏–Ω–µ–π–∫–∞ lifestyle-–±—Ä–µ–Ω–¥–∞.",
          "–í—Å—è –≥—Ä–∞—Ñ–∏–∫–∞ –±—ã–ª–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —á–∏—Å—Ç—ã—Ö –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π, —Ç–∞–∫—Ç–∏–ª—å–Ω—ã—Ö —Ç–∫–∞–Ω–µ–π –∏ –∞–∫—Ü–µ–Ω—Ç–æ–≤ —Ü–≤–µ—Ç–∞ ‚Äî –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ, –Ω–æ —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º.",
        ],
      },
      {
        title: "–†–µ–∑—É–ª—å—Ç–∞—Ç",
        paragraphs: [
          "–ö–æ–ª–ª–µ–∫—Ü–∏—è —Å—Ç–∞–ª–∞ —Å–∞–º—ã–º –∑–∞–º–µ—Ç–Ω—ã–º –º–µ—Ä—á–µ–º –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏: –≥–æ—Å—Ç–∏ –∞–∫—Ç–∏–≤–Ω–æ –æ–±–º–µ–Ω–∏–≤–∞–ª–∏—Å—å —Ñ—É—Ç–±–æ–ª–∫–∞–º–∏ –∏ —Å—É–º–∫–∞–º–∏, –∞ –ø–æ—Å—Ç—ã —Å –º–µ—Ä—á–µ–º Trafee –∑–∞–ø–æ–ª–Ω–∏–ª–∏ —Å–æ—Ü—Å–µ—Ç–∏.",
          "–£—á–∞—Å—Ç–Ω–∏–∫–∏ –æ—Ç–º–µ—á–∞–ª–∏, —á—Ç–æ –≤–∏–∑—É–∞–ª –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –∫–∞–∫ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π fashion-–±—Ä–µ–Ω–¥, –∞ –Ω–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫. –õ–∏–Ω–µ–π–∫—É –ø—Ä–æ–¥–æ–ª–∂–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –ø–æ—Å–ª–µ I-CON –Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö –∏–≤–µ–Ω—Ç–∞—Ö.",
        ],
      },
    ],
  },

  {
    id: "second-project",
    shortTitle: "Second Project",
    title: "–í—Ç–æ—Ä–æ–π –∫–µ–π—Å<br>Creative Direction & Design",
    intro:
      "–ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ –∫–µ–π—Å–∞: –Ω–∞–ø—Ä–∏–º–µ—Ä, Tesla –¥–ª—è —Ç–∞–∫—Å–∏, AI Dating –∏–ª–∏ UCLIQ.",
    theme: {
      bg: "#020712",
      accent: "#ff8a00",
    },
    images: [
      "images/second-1.png",
      "images/second-2.png",
      "images/second-3.png",
      // –ø—Ä–∏–º–µ—Ä –≤–∏–¥–µ–æ:
      // {
      //   type: "video",
      //   src: "media/second-case.mp4",
      //   poster: "images/second-2.png"
      // },
    ],
    textBlocks: [
      {
        title: "–ü—Ä–æ–±–ª–µ–º–∞",
        paragraphs: [
          "–ü–µ—Ä–µ–¥ –±—Ä–µ–Ω–¥–æ–º —Å—Ç–æ—è–ª–∞ –∑–∞–¥–∞—á–∞ –≤—ã–¥–µ–ª–∏—Ç—å—Å—è –≤ –ø–µ—Ä–µ–Ω–∞—Å—ã—â–µ–Ω–Ω–æ–π –Ω–∏—à–µ –∏ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç –∑–∞–º–µ—Ç–Ω—ã–º –∏ –∂–µ–ª–∞–Ω–Ω—ã–º.",
          "–ù—É–∂–Ω–æ –±—ã–ª–æ —Å–æ–∑–¥–∞—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–¥–∞—ë—Ç –æ—â—É—â–µ–Ω–∏–µ –ø—Ä–µ–º–∏–∞–ª—å–Ω–æ–≥–æ, –Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.",
        ],
      },
      {
        title: "–†–µ—à–µ–Ω–∏–µ",
        paragraphs: [
          "–ú—ã —Å–æ–±—Ä–∞–ª–∏ –≤–∏–∑—É–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –≤–æ–∫—Ä—É–≥ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã—Ö –∞–∫—Ü–µ–Ω—Ç–æ–≤, –¥–∏–Ω–∞–º–∏–∫–∏ –∏ –ø–æ–Ω—è—Ç–Ω—ã—Ö UI-–ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤.",
          "–ö–∞–∂–¥—ã–π —ç–∫—Ä–∞–Ω –∏ –≤–∏–∑—É–∞–ª —Ä–∞–±–æ—Ç–∞–ª–∏ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Å—Ç–µ—Ä, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º —Å–æ–±–∏—Ä–∞–ª–∏—Å—å –≤ –µ–¥–∏–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é –±—Ä–µ–Ω–¥–∞.",
        ],
      },
      {
        title: "–†–µ–∑—É–ª—å—Ç–∞—Ç",
        paragraphs: [
          "–ö–∞–º–ø–∞–Ω–∏–∏ —Å –Ω–æ–≤—ã–º –≤–∏–∑—É–∞–ª–æ–º –ø–æ–∫–∞–∑–∞–ª–∏ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π CTR –∏ –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å.",
          "–ó–∞–∫–∞–∑—á–∏–∫ –ø—Ä–æ–¥–æ–ª–∂–∏–ª —Ä–∞–∑–≤–∏–≤–∞—Ç—å –ª–∏–Ω–µ–π–∫—É –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–º–µ–Ω–Ω–æ –≤ —ç—Ç–æ–º —Å—Ç–∏–ª–µ.",
        ],
      },
    ],
  },

  {
    id: "second-project",
    shortTitle: "Second Project",
    title: "–í—Ç–æ—Ä–æ–π –∫–µ–π—Å<br>Creative Direction & Design",
    intro:
      "–ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ –∫–µ–π—Å–∞: –Ω–∞–ø—Ä–∏–º–µ—Ä, Tesla –¥–ª—è —Ç–∞–∫—Å–∏, AI Dating –∏–ª–∏ UCLIQ.",
    theme: {
      bg: "#020712",
      accent: "#ff8a00",
    },
    images: [
      {
        type: "video",
        src: "images/Fantacy_DC_pt3.mp4",
      },
    ],
    textBlocks: [
      {
        title: "–ü—Ä–æ–±–ª–µ–º–∞",
        paragraphs: [
          "–ü–µ—Ä–µ–¥ –±—Ä–µ–Ω–¥–æ–º —Å—Ç–æ—è–ª–∞ –∑–∞–¥–∞—á–∞ –≤—ã–¥–µ–ª–∏—Ç—å—Å—è –≤ –ø–µ—Ä–µ–Ω–∞—Å—ã—â–µ–Ω–Ω–æ–π –Ω–∏—à–µ –∏ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç –∑–∞–º–µ—Ç–Ω—ã–º –∏ –∂–µ–ª–∞–Ω–Ω—ã–º.",
          "–ù—É–∂–Ω–æ –±—ã–ª–æ —Å–æ–∑–¥–∞—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–¥–∞—ë—Ç –æ—â—É—â–µ–Ω–∏–µ –ø—Ä–µ–º–∏–∞–ª—å–Ω–æ–≥–æ, –Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.",
        ],
      },
      {
        title: "–†–µ—à–µ–Ω–∏–µ",
        paragraphs: [
          "–ú—ã —Å–æ–±—Ä–∞–ª–∏ –≤–∏–∑—É–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –≤–æ–∫—Ä—É–≥ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã—Ö –∞–∫—Ü–µ–Ω—Ç–æ–≤, –¥–∏–Ω–∞–º–∏–∫–∏ –∏ –ø–æ–Ω—è—Ç–Ω—ã—Ö UI-–ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤.",
          "–ö–∞–∂–¥—ã–π —ç–∫—Ä–∞–Ω –∏ –≤–∏–∑—É–∞–ª —Ä–∞–±–æ—Ç–∞–ª–∏ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Å—Ç–µ—Ä, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º —Å–æ–±–∏—Ä–∞–ª–∏—Å—å –≤ –µ–¥–∏–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é –±—Ä–µ–Ω–¥–∞.",
        ],
      },
      {
        title: "–†–µ–∑—É–ª—å—Ç–∞—Ç",
        paragraphs: [
          "–ö–∞–º–ø–∞–Ω–∏–∏ —Å –Ω–æ–≤—ã–º –≤–∏–∑—É–∞–ª–æ–º –ø–æ–∫–∞–∑–∞–ª–∏ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π CTR –∏ –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å.",
          "–ó–∞–∫–∞–∑—á–∏–∫ –ø—Ä–æ–¥–æ–ª–∂–∏–ª —Ä–∞–∑–≤–∏–≤–∞—Ç—å –ª–∏–Ω–µ–π–∫—É –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–º–µ–Ω–Ω–æ –≤ —ç—Ç–æ–º —Å—Ç–∏–ª–µ.",
        ],
      },
    ],
  },
];

// ========= –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =========

let currentCaseIndex = 0;

let imageSliderInstance = null;
let textSliderInstance = null;
let projectsSliderInstance = null;

let activeSlider = null; // –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–µ–ª–∫–∞–º–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

// ========= –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =========

document.addEventListener("DOMContentLoaded", () => {
  initParallax();

  initProjectsSlider();
  renderCase(currentCaseIndex);

  // —Å—Ç—Ä–µ–ª–∫–∏ –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ
  document.addEventListener("keydown", (e) => {
    if (!activeSlider) return;
    if (e.key === "ArrowLeft") {
      e.preventDefault();
      activeSlider.prev && activeSlider.prev();
    } else if (e.key === "ArrowRight") {
      e.preventDefault();
      activeSlider.next && activeSlider.next();
    }
  });
});

// ========= –†–ï–ù–î–ï–† –ö–ï–ô–°–ê =========

function renderCase(index) {
  const data = CASES[index];
  if (!data) return;

  currentCaseIndex = index;

  // —Ñ–æ–Ω / –∞–∫—Ü–µ–Ω—Ç
  document.documentElement.style.setProperty("--bg-main", data.theme.bg);
  document.documentElement.style.setProperty(
    "--accent-blue",
    data.theme.accent
  );

  // –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∏–Ω—Ç—Ä–æ
  const titleEl = document.getElementById("case-title");
  const introEl = document.getElementById("case-intro");

  if (titleEl) titleEl.innerHTML = data.title;
  if (introEl) introEl.textContent = data.intro;

  // ===== –°–õ–ê–ô–î–ï–† –ö–ê–†–¢–ò–ù–û–ö / –í–ò–î–ï–û =====
  const imageSliderEl = document.querySelector('[data-slider="images"]');
  const imageTrack = document.querySelector('[data-slider-track="images"]');
  const imageDots = document.querySelector('[data-slider-dots="images"]');

  const imagePrev = document.querySelector('[data-nav-zone="images-prev"]');
  const imageNext = document.querySelector('[data-nav-zone="images-next"]');

  if (imageSliderInstance && imageSliderInstance.destroy) {
    imageSliderInstance.destroy();
  }

  if (imageSliderEl && imageTrack && imageDots) {
    imageTrack.innerHTML = "";
    imageDots.innerHTML = "";

    // –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Å–ø–∏—Å–æ–∫: —Å—Ç—Ä–æ–∫–∞ ‚Üí { type: "image", src }, –æ–±—ä–µ–∫—Ç –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
    const items = data.images.map((media) =>
      typeof media === "string" ? { type: "image", src: media } : media
    );

    imageSliderInstance = createLoopSlider({
      sliderEl: imageSliderEl,
      trackEl: imageTrack,
      dotsEl: imageDots,
      items,
      buildSlide: (item) => {
        const slide = document.createElement("article");
        slide.className = "slider-slide slider-slide--image";

        // –í–ò–î–ï–û
        if (item.type === "video") {
          const video = document.createElement("video");
          video.src = item.src;
          video.controls = true;
          video.playsInline = true;
          video.preload = "metadata";
          video.className = "case-media case-media--video";
          slide.classList.add("slider-slide--video");

          if (item.poster) {
            video.poster = item.poster;
          }

          slide.appendChild(video);
          return slide;
        }

        // –ö–ê–†–¢–ò–ù–ö–ê
        const img = document.createElement("img");
        img.src = item.src;
        img.alt = "";
        img.className = "case-media case-media--image";

        slide.appendChild(img);
        return slide;
      },
      dotClass: "slider-dot",
      dotActiveClass: "slider-dot--active",
      onChange: null,
      arrowPrevEl: imagePrev,
      arrowNextEl: imageNext,
    });
  }

  // ===== –°–õ–ê–ô–î–ï–† –¢–ï–ö–°–¢–ê =====
  const textSliderEl = document.querySelector('[data-slider="text"]');
  const textTrack = document.querySelector('[data-slider-track="text"]');
  const textDots = document.querySelector('[data-slider-dots="text"]');

  const textPrev = document.querySelector('[data-nav-zone="text-prev"]');
  const textNext = document.querySelector('[data-nav-zone="text-next"]');

  if (textSliderInstance && textSliderInstance.destroy) {
    textSliderInstance.destroy();
  }

  if (textSliderEl && textTrack && textDots) {
    textTrack.innerHTML = "";
    textDots.innerHTML = "";

    const items = data.textBlocks;

    textSliderInstance = createLoopSlider({
      sliderEl: textSliderEl,
      trackEl: textTrack,
      dotsEl: textDots,
      items,
      buildSlide: (block) => {
        const card = document.createElement("article");
        card.className = "text-card";

        const header = document.createElement("header");
        header.className = "text-card-header";

        const dot = document.createElement("span");
        dot.className = "text-card-dot";

        const h = document.createElement("h2");
        h.className = "text-card-title";
        h.textContent = block.title;

        header.appendChild(dot);
        header.appendChild(h);

        const body = document.createElement("div");
        body.className = "text-card-body";

        block.paragraphs.forEach((t) => {
          const p = document.createElement("p");
          p.textContent = t;
          body.appendChild(p);
        });

        card.appendChild(header);
        card.appendChild(body);

        return card;
      },
      dotClass: "text-slider-dot",
      dotActiveClass: "text-slider-dot--active",
      onChange: null,
      arrowPrevEl: textPrev,
      arrowNextEl: textNext,
    });
  }

  // –æ–±–Ω–æ–≤–ª—è–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞
  updateProjectPillsActiveState();
}

// ========= –ü–†–û–ï–ö–¢–ù–´–ô –°–õ–ê–ô–î–ï–† (–í–ï–†–•–ù–ò–ô) =========

function initProjectsSlider() {
  const sliderEl = document.querySelector('[data-slider="projects"]');
  const trackEl = document.querySelector('[data-slider-track="projects"]');
  const dotsEl = document.querySelector('[data-slider-dots="projects"]');

  const arrowPrevEl = document.querySelector('[data-nav-zone="projects-prev"]');
  const arrowNextEl = document.querySelector('[data-nav-zone="projects-next"]');

  if (!sliderEl || !trackEl || !dotsEl) return;

  trackEl.innerHTML = "";
  dotsEl.innerHTML = "";

  const items = CASES.map((c) => ({ label: c.shortTitle }));

  projectsSliderInstance = createLoopSlider({
    sliderEl,
    trackEl,
    dotsEl,
    items,
    buildSlide: (item, index) => {
      const slide = document.createElement("div");
      slide.className = "slider-slide slider-slide--project-name";

      const pill = document.createElement("span");
      pill.className =
        "project-pill" + (index === 0 ? " project-pill--active" : "");
      pill.textContent = item.label;

      slide.appendChild(pill);
      return slide;
    },
    dotClass: "slider-dot",
    dotActiveClass: "slider-dot--active",
    onChange: (realIndex) => {
      if (realIndex !== currentCaseIndex) {
        renderCase(realIndex);
      }
    },
    arrowPrevEl,
    arrowNextEl,
  });
}

function updateProjectPillsActiveState() {
  const pills = document.querySelectorAll(".project-pill");

  pills.forEach((pill, idx) => {
    if (idx === currentCaseIndex) {
      // –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
      pill.classList.remove("project-pill--active");
      // —Ñ–æ—Ä—Å–∏–º –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫—É
      void pill.offsetWidth;
      pill.classList.add("project-pill--active");
    } else {
      pill.classList.remove("project-pill--active");
    }
  });
}

// ========= –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –ë–ï–°–®–û–í–ù–´–ô –°–õ–ê–ô–î–ï–† =========

function createLoopSlider({
  sliderEl,
  trackEl,
  dotsEl,
  items,
  buildSlide,
  dotClass,
  dotActiveClass,
  onChange,
  arrowPrevEl,
  arrowNextEl,
}) {
  if (!items || items.length === 0) {
    return {
      prev() {},
      next() {},
      destroy() {},
    };
  }

  const realCount = items.length;

  // —Å–æ–∑–¥–∞—ë–º —Ä–µ–∞–ª—å–Ω—ã–µ —Å–ª–∞–π–¥—ã
  const realSlides = items.map((item, i) => buildSlide(item, i));

  // –æ—á–∏—â–∞–µ–º —Ç—Ä–µ–∫
  trackEl.innerHTML = "";

  // –∫–ª–æ–Ω—ã –¥–ª—è –±–µ—Å—à–æ–≤–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
  const firstClone = buildSlide(items[0], 0);
  const lastClone = buildSlide(items[realCount - 1], realCount - 1);
  firstClone.dataset.clone = "true";
  lastClone.dataset.clone = "true";

  trackEl.appendChild(lastClone);
  realSlides.forEach((slide) => trackEl.appendChild(slide));
  trackEl.appendChild(firstClone);

  // —Ç–æ—á–∫–∏
  dotsEl.innerHTML = "";
  const dots = [];
  for (let i = 0; i < realCount; i++) {
    const dot = document.createElement("span");
    dot.className = dotClass + (i === 0 ? ` ${dotActiveClass}` : "");
    dot.addEventListener("click", () => {
      goToSlide(i + 1, true);
    });
    dotsEl.appendChild(dot);
    dots.push(dot);
  }

  let currentIndex = 1; // –∏–Ω–¥–µ–∫—Å –≤ allSlides (0..realCount+1)
  let isTransitioning = false;

  function setTransition(enable) {
    trackEl.style.transition = enable
      ? "transform 0.6s cubic-bezier(.34,0.6,.64,1)"
      : "none";
  }

  function applyTransform() {
    const offset = -currentIndex * 100;
    trackEl.style.transform = `translateX(${offset}%)`;
  }

  function getRealIndex() {
    if (currentIndex === 0) return realCount - 1;
    if (currentIndex === realCount + 1) return 0;
    return currentIndex - 1;
  }

  function updateDots() {
    const realIndex = getRealIndex();
    dots.forEach((dot, idx) => {
      dot.classList.toggle(dotActiveClass, idx === realIndex);
    });
  }

  function goToSlide(index, animate) {
    if (isTransitioning && animate) return;
    currentIndex = index;
    setTransition(animate);
    applyTransform();
    updateDots();
  }

  function goNext() {
    goToSlide(currentIndex + 1, true);
  }

  function goPrev() {
    goToSlide(currentIndex - 1, true);
  }

  // transition —Å–æ–±—ã—Ç–∏—è
  const onTransitionStart = () => {
    isTransitioning = true;
  };

  const onTransitionEnd = () => {
    isTransitioning = false;

    if (currentIndex === 0) {
      setTransition(false);
      currentIndex = realCount;
      applyTransform();
    } else if (currentIndex === realCount + 1) {
      setTransition(false);
      currentIndex = 1;
      applyTransform();
    }

    const realIndex = getRealIndex();
    if (typeof onChange === "function") {
      onChange(realIndex);
    }
  };

  trackEl.addEventListener("transitionstart", onTransitionStart);
  trackEl.addEventListener("transitionend", onTransitionEnd);

  // —Å—Ç—Ä–µ–ª–∫–∏
  if (arrowPrevEl) {
    arrowPrevEl.addEventListener("click", (e) => {
      e.preventDefault();
      goPrev();
    });
  }

  if (arrowNextEl) {
    arrowNextEl.addEventListener("click", (e) => {
      e.preventDefault();
      goNext();
    });
  }

  // === TOUCH SWIPE (–ù–û–†–ú –î–õ–Ø –ú–û–ë–ò–õ–û–ö) ===
  let touchStartX = 0;
  let touchStartY = 0;
  let lastTouchX = 0;
  let lastTouchY = 0;
  let isTouching = false;
  let isHorizontalSwipe = false;
  const swipeThreshold = 30; // –Ω–µ–º–Ω–æ–≥–æ –º—è–≥—á–µ –ø–æ—Ä–æ–≥

  const onTouchStart = (e) => {
    if (!e.touches || !e.touches[0]) return;

    // üëâ –µ—Å–ª–∏ –∂–µ—Å—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞ –≤–∏–¥–µ–æ ‚Äî –Ω–µ –≤–∫–ª—é—á–∞–µ–º —Å–≤–∞–π–ø —Å–ª–∞–π–¥–µ—Ä–∞
    const target = e.target;
    if (target && target.closest && target.closest(".case-media--video")) {
      return;
    }

    const t = e.touches[0];
    isTouching = true;
    isHorizontalSwipe = false;
    touchStartX = t.clientX;
    touchStartY = t.clientY;
    lastTouchX = t.clientX;
    lastTouchY = t.clientY;
  };

  const onTouchMove = (e) => {
    if (!isTouching || !e.touches || !e.touches[0]) return;
    const t = e.touches[0];
    const dx = t.clientX - touchStartX;
    const dy = t.clientY - touchStartY;

    // –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–∞–π–ø–∞
    if (!isHorizontalSwipe) {
      if (Math.abs(dx) > 8 && Math.abs(dx) > Math.abs(dy)) {
        // –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –∂–µ—Å—Ç ‚Üí –±–µ—Ä—ë–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ–±—è
        isHorizontalSwipe = true;
      } else if (Math.abs(dy) > Math.abs(dx)) {
        // –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –∂–µ—Å—Ç ‚Üí –Ω–µ –º–µ—à–∞–µ–º —Å–∫—Ä–æ–ª–ª—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        isHorizontalSwipe = false;
        return;
      }
    }

    if (isHorizontalSwipe) {
      // –±–ª–æ–∫–∏—Ä—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª/–ø–µ—Ä–µ–ª–∏—Å—Ç—ã–≤–∞–Ω–∏–µ
      e.preventDefault();
      lastTouchX = t.clientX;
      lastTouchY = t.clientY;
    }
  };

  const onTouchEnd = (e) => {
    if (!isTouching) return;
    isTouching = false;

    const t = (e.changedTouches && e.changedTouches[0]) || {
      clientX: lastTouchX,
      clientY: lastTouchY,
    };

    const dx = t.clientX - touchStartX;
    const dy = t.clientY - touchStartY;

    if (!isHorizontalSwipe) return;
    if (Math.abs(dx) < swipeThreshold || Math.abs(dx) < Math.abs(dy) * 0.5) {
      // —Å–≤–∞–π–ø —Å–ª–∞–±—ã–π –∏–ª–∏ –ø–æ—á—Ç–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
      return;
    }

    if (dx > 0) {
      goPrev();
    } else {
      goNext();
    }
  };

  // –Ω–∞—á–∞–ª–æ –∏ –¥–≤–∏–∂–µ–Ω–∏–µ ‚Äî –Ω–∞ –≤—Å—ë–º —Å–ª–∞–π–¥–µ—Ä–µ
  sliderEl.addEventListener("touchstart", onTouchStart, { passive: true });
  sliderEl.addEventListener("touchmove", onTouchMove, { passive: false });
  sliderEl.addEventListener("touchend", onTouchEnd, { passive: true });

  // mouse drag
  let isMouseDown = false;
  let mouseStartX = 0;
  let mouseStartY = 0;

  const onMouseDown = (e) => {
    if (e.button !== 0) return;

    // üëâ –µ—Å–ª–∏ –∫–ª–∏–∫/drag –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞ –≤–∏–¥–µ–æ ‚Äî –Ω–µ –≤–∫–ª—é—á–∞–µ–º drag-—Å–≤–∞–π–ø —Å–ª–∞–π–¥–µ—Ä–∞
    const target = e.target;
    if (target && target.closest && target.closest(".case-media--video")) {
      return;
    }

    isMouseDown = true;
    mouseStartX = e.clientX;
    mouseStartY = e.clientY;
  };

  const onMouseUp = (e) => {
    if (!isMouseDown) return;
    isMouseDown = false;

    const dx = e.clientX - mouseStartX;
    const dy = e.clientY - mouseStartY;

    if (Math.abs(dy) > Math.abs(dx)) return;

    if (dx > 25) {
      goPrev();
    } else if (dx < -25) {
      goNext();
    }
  };

  trackEl.addEventListener("mousedown", onMouseDown);
  document.addEventListener("mouseup", onMouseUp);

  // wheel / —Ç–∞—á–ø–∞–¥
  let wheelLocked = false;
  const wheelThreshold = 20;
  const wheelLockTime = 250;

  const onWheel = (e) => {
    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) return;
    const dx = e.deltaX;
    if (Math.abs(dx) < wheelThreshold) return;
    if (wheelLocked) return;

    wheelLocked = true;
    if (dx > 0) {
      goNext();
    } else if (dx < 0) {
      goPrev();
    }

    setTimeout(() => {
      wheelLocked = false;
    }, wheelLockTime);
  };

  sliderEl.addEventListener("wheel", onWheel, { passive: true });

  // –∞–∫—Ç–∏–≤–Ω—ã–π —Å–ª–∞–π–¥–µ—Ä –¥–ª—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
  const onMouseEnter = () => {
    activeSlider = api;
  };
  const onMouseLeave = () => {
    if (activeSlider === api) {
      activeSlider = null;
    }
  };

  sliderEl.addEventListener("mouseenter", onMouseEnter);
  sliderEl.addEventListener("mouseleave", onMouseLeave);

  // —Å—Ç–∞—Ä—Ç
  setTransition(false);
  applyTransform();
  updateDots();

  const api = {
    prev: goPrev,
    next: goNext,
    destroy() {
      trackEl.removeEventListener("transitionstart", onTransitionStart);
      trackEl.removeEventListener("transitionend", onTransitionEnd);
      sliderEl.removeEventListener("touchstart", onTouchStart);
      sliderEl.removeEventListener("touchmove", onTouchMove);
      sliderEl.removeEventListener("touchend", onTouchEnd);
      trackEl.removeEventListener("mousedown", onMouseDown);
      document.removeEventListener("mouseup", onMouseUp);
      sliderEl.removeEventListener("wheel", onWheel);
      sliderEl.removeEventListener("mouseenter", onMouseEnter);
      sliderEl.removeEventListener("mouseleave", onMouseLeave);
      if (activeSlider === api) {
        activeSlider = null;
      }
    },
  };

  return api;
}

// ========= –ü–ê–†–ê–õ–õ–ê–ö–° =========

function initParallax() {
  const items = Array.from(document.querySelectorAll(".parallax-item"));
  if (items.length === 0) return;

  let ticking = false;

  function onScroll() {
    if (!ticking) {
      window.requestAnimationFrame(() => {
        updateParallax(items);
        ticking = false;
      });
      ticking = true;
    }
  }

  window.addEventListener("scroll", onScroll, { passive: true });
  window.addEventListener("resize", () => updateParallax(items));

  updateParallax(items);
}

function updateParallax(items) {
  const viewportHeight =
    window.innerHeight || document.documentElement.clientHeight;
  const maxShift = 16;

  items.forEach((el) => {
    const rect = el.getBoundingClientRect();
    const elCenter = rect.top + rect.height / 2;
    const viewportCenter = viewportHeight / 2;

    const rel = (elCenter - viewportCenter) / viewportHeight;
    const shift = -rel * maxShift;

    el.style.transform = `translateY(${shift}px)`;
  });
}
